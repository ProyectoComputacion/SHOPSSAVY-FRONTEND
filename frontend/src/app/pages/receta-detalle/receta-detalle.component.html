<!-- Falta esto (CSS de Bootstrap) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Falta esto (JS de Bootstrap) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Bootstrap Icons -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
/>
<div class="py-4 bg-beige">
  <div class="container page-container">

    <!-- Encabezado con imagen y overlay gradient -->
    <div *ngIf="receta" class="receta-header">
      <img [src]="receta.imagen" alt="{{ receta.name }}" class="receta-img" />
      <div class="receta-overlay">
        <h3 class="receta-name">{{ receta.name }}</h3>
        <p class="receta-tipo">
          {{ receta.tipo === 'Recetas Michelin' ? 'Michelin ' : 'Normal ' }}
        </p>
      </div>
    </div>


    <!-- Ingredientes -->
    <div class="receta-info">
      <h4>Ingredientes</h4>
      <ul *ngIf="ingredientes.length > 0">
        <li *ngFor="let ing of ingredientes">
          <strong>{{ ing.quantity }} {{ ing.unit }}</strong> ‚Äì {{ ing.name }}
        </li>
      </ul>
      <p *ngIf="ingredientes.length === 0" class="text-muted">
        No hay ingredientes disponibles.
      </p>
      <!-- Calorias -->
      <p *ngIf="cargandoCalorias">‚è≥ Calculando calor√≠as...</p>
      <p *ngIf="!cargandoCalorias && calorias > 0"> Calor√≠as estimadas: {{ calorias }} kcal</p>
    </div>

    <!-- Acciones -->
    <div class="receta-acciones">
      <button class="btn-volver" (click)="volver()">‚Üê Volver</button>
      <button
      type="button"
       class="btn-calificar"
      (click)="calificar()"
      >
        ‚≠ê Calificar
      </button>
      <button class="btn-carrito" (click)="agregarAlCarrito()">
        üõí A√±adir al carrito
      </button>
    </div>

  </div>
</div>

<!-- Modal Carrito -->
<div
  class="modal fade"
  id="carritoModal"
  tabindex="-1"
  aria-labelledby="carritoModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content rounded-3">
      <div class="modal-header">
        <h5 class="modal-title" id="carritoModalLabel">Receta A√±adida</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Cerrar"
        ></button>
      </div>
      <div class="modal-body text-center">
        üõí La receta ha sido a√±adida con √©xito.
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-primary"
          data-bs-dismiss="modal"
        >
          Aceptar
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Calificar -->
<div
  class="modal fade"
  id="calificarModal"
  tabindex="-1"
  aria-labelledby="calificarModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content rounded-3 text-center p-3">
      <div class="modal-header border-0">
        <h5 class="modal-title" id="calificarModalLabel">Calificar Receta</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Cerrar"
        ></button>
      </div>
      <div class="modal-body">
        <div class="estrellas">
          <ng-container *ngFor="let estrella of [1,2,3,4,5]">
            <i
              class="bi"
              [ngClass]="
                estrella <= calificacionSeleccionada
                  ? 'bi-star-fill text-warning'
                  : 'bi-star text-secondary'
              "
              (click)="seleccionarCalificacion(estrella)"
            ></i>
          </ng-container>
        </div>
        <button
          class="btn btn-success mt-3"
          (click)="confirmarCalificacion()"
        >
          Confirmar
        </button>
        <div
          *ngIf="mensajeConfirmacion"
          class="alert alert-success mt-3 mb-0"
        >
          ¬°Calificaci√≥n enviada!
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Local de Autenticaci√≥n -->
<div class="modal fade" id="authModalLocal" tabindex="-1" aria-labelledby="authModalLocalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-center">
      
      <div class="modal-header">
        <h5 class="modal-title w-100" id="authModalLocalLabel">Inicio de sesi√≥n requerido</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      
      <div class="modal-body">
        <p>Para realizar esta acci√≥n necesitas tener una cuenta.</p>
        <div class="d-flex justify-content-center gap-3 mt-3">
          <button class="btn btn-outline-primary" (click)="redirigirLogin()">Iniciar sesi√≥n</button>
          <button class="btn btn-outline-secondary" (click)="redirigirRegistro()">Registrarse</button>
        </div>
      </div>

    </div>
  </div>
</div>
